<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>阅读</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/page_main.css">
    <link rel="stylesheet" href="./css/page_search.css">
    <link rel="stylesheet" href="./css/page_plugin.css">
    <link rel="stylesheet" href="./css/page_about.css">
    <link rel="stylesheet" href="./css/page_info.css">
    <link rel="stylesheet" href="./css/page_toc.css">
    <link rel="stylesheet" href="./css/page_content.css">
    <link rel="stylesheet" href="./css/page_setting.css">
    <link rel="stylesheet" href="./css/dialog_layer.css">

</head>
<body>
    <div class="container">
        <div class="page main">
            <div class="view">
                <div class="head">
                    <div class="shelf_title_group">
                        <div class="btn selected"> 书架 </div>
                    </div>
                    <div class="btn search"> 🔍 搜索 </div>
                    <div class="btn setting"> ⚙️ 设置 </div>
                </div>
                <div class="body">
                    <div class="shelf">
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                        <div class="book btn"> <div class="name">书名</div></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="page search hide">
            <div class="view">
                <div class="head">
                    <div class="btn btn-back-page">🔙 返回</div>
                    <input type="text" name="" class="search-bar-input" >
                    <div class="btn btn-search">🔍 搜索</div>
                </div>
                <div class="body">
                    <div class="search-list">
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                        <div class="item btn">搜索结果1</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="page plugin hide">
            <div class="view">
                <div class="head">
                    <div class="btn btn-back-page">🔙 返回</div>
                    <div class="btn">插件管理器</div>
                    <div class="btn btn-add-plugin">⚙️ 新增</div>
                </div>
                <div class="body">
                    <div class="plugin_list">
                        <div class="item" url="http://www.xiaoshuwu.com"> 
                            <input class="checkbox selected" type="checkbox" name="" > <div class="name">插件名</div>
                            <div>启用?</div> <input type="checkbox" name="" > <div> | </div>
                            <div class="btn">编辑</div> 
                        </div>
                        <div class="item" url="http://www.xiaoshuwu.com"> 
                            <input class="checkbox selected" type="checkbox" name="" > <div class="name">插件名</div>
                            <div >启用?</div> <input type="checkbox" name="" > <div> | </div>
                            <div class="btn">编辑</div> 
                        </div>
                    </div>
                </div>
                <div class="foot">
                    <div class="btn"> <input type="checkbox" name="" id="sleect_all_plugins"> <label for="#sleect_all_plugins">全选</label> </div>
                    <div class="btn select_invert" > 反选 </div>
                    <div class="btn delete"> 删除选中 </div>
                    <!-- <div class="btn"> ⚙️ 设置 </div> -->
                </div>
            </div>
        </div>
        <div class="page about hide">
            <div class="view">
                <div class="head">
                    <div class="btn">🔙 返回</div>
                    <div class="btn">关于</div>
                    <div class="btn">🔗 分享</div>
                </div>
                <div class="body">
                    <div class="btn">软件介绍：这是一款使用Electron开发的开源阅读软件。</div>
                    <div class="btn">开发人员：ty</div>
                    <div class="btn">更新日志：(version 0.0.1)</div>
                    <div class="btn">联系邮件：xxxxxx@123.com</div>
                    <div class="btn">联系 QQ ：xxxxxxxxxxx</div>
                    <div class="btn">开源地址：https://github.com/ty/xxxxx</div>
                    <div class="btn">开源协议：第三版本GPL开源协议</div>
                    <div class="btn">免责声明</div>
                </div>
            </div>
        </div>
        <div class="page info hide">
            <div class="view">
                <div class="head">
                    <div class="btn btn-back-page">🔙 返回</div>
                    <div class="btn"> 书籍信息 </div>
                    <div class="btn">⚙️ 设置</div>
                </div>
                <div class="body">
                    <div class="item"><span>名称：</span><span class="book_name">书籍名称</span></div>
                    <div class="item"><span>作者：</span><span class="book_author">作者名称</span></div>
                    <div class="item btn_line"><span>书源：</span><span class="source_name">书源名称</span><div class="btn change_source">更换书源</div></div>
                    <!-- <div class="item btn_line"><span>分组：</span><span>分组名称</span><div class="btn">设置分组</div></div> -->
                    <div class="item btn_line"><span>最新章节：</span><span class="book_latest_chapter">最新章节</span><div class="btn show_toc">查看目录</div></div>
                    <div class="item"><span>简介：</span><span class="book_intro">书籍简介</span></div>
                </div>
                <div class="foot">
                    <div class="btn"> 删除 </div>
                    <div class="btn"> 阅读 </div>
                </div>
            </div>
        </div>
        <div class="page toc hide">
            <div class="view">
                <div class="head">
                    <div class="btn btn-back-page">🔙 返回</div>
                    <div class="btn">章节列表</div>
                    <div class="btn">  </div>
                </div>
                <div class="body">
                    <div class="btn"><span> 章节名称 1 </span><span>✔️</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>✔️</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>❌</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>❌</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>❌</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>❌</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>✔️</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>✔️</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>✔️</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>✔️</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>✔️</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>✔️</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>✔️</span></div>
                    <div class="btn"><span> 章节名称 1 </span><span>✔️</span></div>
                </div>
            </div>
        </div>
        <div class="page content hide">
            <div class="view">
                <div class="head hide">
                    <div class="btn">🔙 返回</div>
                    <div class="btn"> 《都市之流氓老师》</div>
                    <div class="btn">⚙️ 设置</div>
                </div>
                <div class="body"><div class="text_content"></div></div>
                <div class="foot hide">
                    <div class="btn"> 上一章 </div>
                    <div class="btn"> 目录 </div>
                    <div class="btn"> 界面 </div>
                    <div class="btn"> 设置 </div>
                    <div class="btn"> 下一章 </div>
                </div>
            </div>
        </div>
        <div class="page setting hide">
            <div class="view">
                <div class="head">
                    <div class="btn btn-back-page">🔙 返回</div>
                    <div class="btn">设置</div>
                    <div class="btn"></div>
                </div>
                <div class="body">
                    <div class="btn source-plugin">书源配置</div>
                    <div class="btn">替换净化</div>
                    <div class="btn">预下载章节</div>
                    <div class="btn">默认用户代理</div>
                    <div class="btn">记录日志（关闭）</div>
                    <div class="btn">关于</div>
                </div>
            </div>
        </div>
    </div>

    <div id="dialog-layer" class="dialog_layer" >
        <div class="dialog loading">
            <div class="text"> 初始化中, 请等待... <br> <span id="loading_process">0</span> </div>
        </div>
        <div class="dialog menu hide">
            <div class="btn">更新目录</div>
            <div class="btn">添加本地</div>
            <div class="btn">分组管理</div>
            <div class="btn">缓存导出</div>
            <div class="btn">书架布局</div>
        </div>
        <div class="dialog alert hide">
            <div class="text">这是一个Alert警报！！这是一个Alert警报！！</div>
            <div class="btn">确认</div>
        </div>
    </div>
</body>
<script_box>
    <!-- 第三方库 -->
    <script src="./js/jsstore.js"></script>
    <script src="./js/jsstore.worker.js"></script>
    <!-- 自定义脚本 基于jsstore的数据库对象 db -->
    <script src="./js/db.js"></script>
    <!-- 自定义脚本 全局 -->
    <script src="./js/global.js"></script>
    <!-- 自定义脚本 页面方法及事件绑定 -->
    <script src="./js/page_main.js"></script>
    <script src="./js/page_search.js"></script>
    <script src="./js/page_info.js"></script>
    <script src="./js/page_toc.js"></script>
    <script src="./js/page_content.js"></script>
    <script src="./js/page_setting.js"></script>
    <script src="./js/page_plugin.js"></script>
    
    <script process>
        /** 流程管理，执行初始化数据库、页面等操作，在初始化结束后屏蔽loading弹窗，显示主页，让用户开始操作 */
        (async function processManager(){
            //初始化数据库，获得全局变量 db
            document.getElementById('loading_process').innerText = '0%';
            await db.init();
            document.getElementById('loading_process').innerText = '初始化数据库<20%>';
            //初始化管理器
            await sourceManager.init();
            document.getElementById('loading_process').innerText = '初始化管理器<40%>';
            //初始化页面
            console.log('初始化各个页面');
            document.getElementById('loading_process').innerText = '初始化各个页面<60%>';
            await content.init(); console.log("页面更新成功：阅读");
            document.getElementById('loading_process').innerText = '页面更新成功：阅读<80%>';
            await plugin.init();  console.log("页面更新成功：书源");
            document.getElementById('loading_process').innerText = '页面更新成功：书源<100%>';
            // await utils.asleep(1000);
            // 初始化结束，关闭loading dialog的遮挡
            utils.hideDialogLayer();
        })();
        
    </script>

    <script src="./js/test.js"></script>
    <script test>
        // content.setText(test.novel);

        /*test*/
        async function testGet(chapterIndex){
            const val = await electronAPI.getChapterContent('book', chapterIndex);
            console.log('get res: ', val);
        }

        async function testSave(chapterIndex){
            const val = await electronAPI.saveChapterContent('book', chapterIndex, 'asdasdasd'+chapterIndex);
            console.log('save res: ', val);
        }

    </script>
</script_box>

</html>